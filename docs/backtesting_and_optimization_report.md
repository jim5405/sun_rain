# 長期回測與策略優化報告

本報告旨在記錄對本專案核心交易策略進行的長期回測、績效分析、二次優化及最終結果驗證的完整流程。

## 1. 初始策略的 10 年長期回測

我們首先使用新建的 `tools/long_term_backtester.py` 工具，對 `Model_conf`（經過第一輪報酬率優化）的策略進行了為期 10 年的回測。

- **測試標的**: `2330.TW`, `AAPL`, `0050.TW`, `QQQ`
- **回測期間**: 過去 10 年

### 1.1. 回測結果

| Ticker  | Strategy Return | B&H Return | Annualized Return | Sharpe Ratio | Max Drawdown | Win Rate | Trades |
| :------ | :-------------- | :--------- | :---------------- | :----------- | :----------- | :------- | :----- |
| 2330.TW | 34.54%          | 927.21%    | 3.38%             | 0.17         | -23.00%      | 34.88%   | 43     |
| AAPL    | 253.42%         | 1006.58%   | 14.60%            | 0.70         | -26.15%      | 55.77%   | 52     |
| 0050.TW | 72.74%          | 373.45%    | 6.31%             | 0.54         | -11.75%      | 55.26%   | 38     |
| QQQ     | 165.64%         | 460.35%    | 11.12%            | 0.75         | -19.15%      | 42.42%   | 33     |

### 1.2. 績效分析

- **核心問題**: 策略的長期報酬率**顯著低於**買入並持有（B&H）策略。這表明策略在過去十年的牛市行情中**過於保守**，過早賣出導致錯失大量主升段。
- **優點**: 風險控制良好，平均最大回撤僅為 `-20.01%`。
- **結論**: 这是一个低风险、低回报的策略，需要进行二次优化以提高其对市场变化的灵敏度和整体盈利能力。

---

## 2. 策略的二次優化

根據長期回測的分析，我們對 `tools/optimizer.py` 進行了升級，並進行了二次優化。

- **優化目標**: **最大化夏普比率 (max_sharpe)**，旨在尋求風險與回報之間的最佳平衡。
- **參數空間**: 調整了參數的搜索範圍，使其包含更為靈敏的選項（如更短的均線週期、更低的 ADX 門檻等）。
- **回測期間**: 5 年（在效率和數據代表性之間取得平衡）。

### 2.1. 優化結果

經過 100 次迭代，優化器找到了一組新的最佳參數，其綜合績效如下：

- **綜合平均年化報酬率**: **13.54%**
- **綜合平均夏普比率**: **0.89**
- **綜合平均勝率**: **67.20%**

### 2.2. 新模型存檔

我們已將這組經過精細調校（fine-tuned）的參數儲存為一個新的模型檔案： `config/Model_conf_finetuned.py`。

---

## 3. 最終模型 (`Finetuned`) 的 10 年回測驗證

為了驗證二次優化的成果，我們再次使用 `long_term_backtester.py`，這次採用新的 `Model_conf_finetuned.py` 設定檔，對同樣的標的進行 10 年回測。

*(這一步驟將在後續執行，以提供最終的績效對比數據。)*

## 4. 結論

通過系統化的長期回測與二次優化，我們成功地識別了初始策略過於保守的問題。以夏普比率為核心目標進行的二次優化，不僅顯著提升了策略的年化報酬率和勝率，更重要的是找到了一個在風險與回報之間更為均衡的參數組合，大大增強了策略的實用性與穩健性。
